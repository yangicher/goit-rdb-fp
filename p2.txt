CREATE TABLE entities (
  id INT AUTO_INCREMENT PRIMARY KEY,
  entity_name VARCHAR(255),
  code VARCHAR(50)
);

INSERT INTO entities (entity_name, code)
SELECT DISTINCT Entity, Code FROM infectious_cases;

CREATE TABLE infectious_data (
  id INT AUTO_INCREMENT PRIMARY KEY,
  entity_id INT,
  year INT,
  number_rabies INT,
  FOREIGN KEY (entity_id) REFERENCES entities(id)
);

INSERT INTO infectious_data (entity_id, year, number_rabies)
SELECT 
  e.id, 
  ic.Year, 
  NULLIF(ic.Number_rabies, '') 
FROM infectious_cases ic
JOIN entities e ON ic.Entity = e.entity_name AND ic.Code = e.code;

SELECT COUNT(*) FROM infectious_cases;